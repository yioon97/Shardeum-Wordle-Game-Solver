<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shardeum Wordle Game Solver</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center; /* Center align all text */
        }
        .input-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap; /* Allow wrapping for smaller screens */
        }
        .input-box {
            width: 40px;
            height: 40px;
            margin: 5px;
            text-align: center;
            font-size: 18px;
            text-transform: uppercase; /* Force uppercase input */
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px; /* Slight border radius */
            box-shadow: none; /* Remove shadow */
            outline: none; /* Remove default focus outline */
        }
        .input-box:focus {
            border-color: #3042fb; /* Focus color */
        }
        .button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background-color: #3042fb;
            color: #fff;
        }
        .result {
            margin-top: 20px;
            font-size: 18px;
        }
        .section {
            margin-bottom: 20px;
        }
        .section h3 {
            margin-bottom: 10px;
        }
        /* Background colors for input boxes */
        #correct-positions .input-box {
            background-color: #a4ff00; /* Green for correct positions */
        }
        #incorrect-positions .input-box {
            background-color: #fbff1e; /* Yellow for incorrect positions */
        }
        #excluded-letters .input-box {
            background-color: #72716c; /* Gray for excluded letters */
        }
        /* Responsive design */
        @media (max-width: 600px) {
            .input-box {
                width: 30px;
                height: 30px;
                font-size: 16px;
            }
            .button {
                padding: 8px 16px;
                font-size: 14px;
            }
        }
        /* Copy button */
        #copy-button {
            display: none; /* Hidden by default */
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Shardeum Wordle Game Solver</h1>

    <!-- Correct Positions -->
    <div class="section">
        <h3>Correct Positions</h3>
        <div class="input-container" id="correct-positions">
            <input type="text" class="input-box" maxlength="1" data-index="0">
            <input type="text" class="input-box" maxlength="1" data-index="1">
            <input type="text" class="input-box" maxlength="1" data-index="2">
            <input type="text" class="input-box" maxlength="1" data-index="3">
            <input type="text" class="input-box" maxlength="1" data-index="4">
        </div>
    </div>

    <!-- Incorrect Positions -->
    <div class="section">
        <h3>Incorrect Positions (Letters in the word but wrong position)</h3>
        <div class="input-container" id="incorrect-positions">
            <input type="text" class="input-box" maxlength="1" data-index="0">
            <input type="text" class="input-box" maxlength="1" data-index="1">
            <input type="text" class="input-box" maxlength="1" data-index="2">
            <input type="text" class="input-box" maxlength="1" data-index="3">
            <input type="text" class="input-box" maxlength="1" data-index="4">
        </div>
    </div>

    <!-- Excluded Letters -->
    <div class="section">
        <h3>Excluded Letters (Letters not in the word)</h3>
        <div class="input-container" id="excluded-letters">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
            <input type="text" class="input-box" maxlength="1">
        </div>
    </div>

    <!-- Solve and Clear Buttons -->
    <div>
        <button class="button" onclick="solveWordle()">Solve</button>
        <button class="button" onclick="clearInputs()">Clear</button>
    </div>

    <!-- Results -->
    <div class="result" id="result"></div>

    <!-- Copy Button -->
    <button class="button" id="copy-button" onclick="copyWord()">Copy</button>

    <script>
        let wordList = [];

        // Load words from GitHub
        async function loadWordList() {
            const url = 'https://raw.githubusercontent.com/yioon97/Wordle-Solver/refs/heads/main/words.txt';
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Failed to fetch word list: ${response.status} ${response.statusText}`);
                }
                const text = await response.text();
                wordList = text.split('\n').map(word => word.trim().toLowerCase()).filter(word => word.length === 5);
                console.log("Word list loaded:", wordList);
            } catch (error) {
                console.error("Error loading word list:", error);
            }
        }

        // Helper function to get letters from input boxes
        function getLettersFromInputs(containerId) {
            const letters = {};
            document.querySelectorAll(`#${containerId} .input-box`).forEach(input => {
                const index = parseInt(input.getAttribute('data-index'));
                const letter = input.value.toUpperCase(); // Ensure uppercase
                if (letter) {
                    letters[index] = letter.toLowerCase(); // Store in lowercase for filtering
                }
            });
            console.log(`Letters from ${containerId}:`, letters);
            return letters;
        }

        // Helper function to get excluded letters from input boxes
        function getExcludedLetters(containerId) {
            const excludedLetters = new Set();
            document.querySelectorAll(`#${containerId} .input-box`).forEach(input => {
                const letter = input.value.toUpperCase(); // Ensure uppercase
                if (letter) {
                    excludedLetters.add(letter.toLowerCase()); // Store in lowercase for filtering
                }
            });
            console.log(`Excluded letters from ${containerId}:`, [...excludedLetters]);
            return excludedLetters;
        }

        function filterWords(correctPositions, incorrectPositions, excludedLetters) {
            let filteredWords = wordList.filter(word => {
                // Filter by correct positions
                for (const [index, letter] of Object.entries(correctPositions)) {
                    if (word[index] !== letter) {
                        console.log(`Word ${word} failed at correct position ${index}: expected ${letter}, got ${word[index]}`);
                        return false;
                    }
                }
                // Filter by incorrect positions
                for (const [index, letter] of Object.entries(incorrectPositions)) {
                    if (!word.includes(letter)) {
                        console.log(`Word ${word} does not contain ${letter} at all`);
                        return false;
                    }
                    if (word[index] === letter) {
                        console.log(`Word ${word} has ${letter} at incorrect position ${index}`);
                        return false;
                    }
                }
                // Filter by excluded letters
                for (const letter of excludedLetters) {
                    if (word.includes(letter)) {
                        console.log(`Word ${word} contains excluded letter ${letter}`);
                        return false;
                    }
                }
                return true;
            });
            console.log("Filtered words:", filteredWords);
            return filteredWords;
        }

        // Function to copy the word to clipboard
        function copyWord() {
            const resultDiv = document.getElementById('result');
            const word = resultDiv.textContent.replace("Possible word(s): ", "").split(",")[0].trim();
            navigator.clipboard.writeText(word).then(() => {
                alert(`Copied: ${word}`);
            }).catch(() => {
                alert("Failed to copy word.");
            });
        }

        function solveWordle() {
            console.log("Solving Wordle...");

            // Get correct positions
            const correctPositions = getLettersFromInputs('correct-positions');

            // Get incorrect positions
            const incorrectPositions = getLettersFromInputs('incorrect-positions');

            // Get excluded letters
            const excludedLetters = getExcludedLetters('excluded-letters');

            // Filter words
            const possibleWords = filterWords(correctPositions, incorrectPositions, excludedLetters);

            // Display results with first letter capitalized
            const resultDiv = document.getElementById('result');
            const copyButton = document.getElementById('copy-button');
            if (possibleWords.length === 0) {
                resultDiv.textContent = "No possible words found.";
                copyButton.style.display = "none"; // Hide copy button
            } else {
                const formattedWords = possibleWords.map(word => word.charAt(0).toUpperCase() + word.slice(1));
                resultDiv.textContent = "Possible word(s): " + formattedWords.join(', ');
                // Show copy button only if there is exactly one word
                if (possibleWords.length === 1) {
                    copyButton.style.display = "inline-block";
                } else {
                    copyButton.style.display = "none";
                }
            }
        }

        // Clear all input boxes, results, and hide copy button
        function clearInputs() {
            document.querySelectorAll('.input-box').forEach(input => {
                input.value = ''; // Clear input
            });
            document.getElementById('result').textContent = ''; // Clear results
            document.getElementById('copy-button').style.display = "none"; // Hide copy button
        }

        // Replace current letter on focus and typing
        document.querySelectorAll('.input-box').forEach(input => {
            input.addEventListener('focus', () => {
                input.value = ''; // Clear the input when focused
            });
        });

        // Autofocus next/previous input box for excluded letters
        document.getElementById('excluded-letters').addEventListener('input', (event) => {
            const input = event.target;
            if (input.value.length === 1) {
                const nextInput = input.nextElementSibling;
                if (nextInput) {
                    nextInput.focus();
                }
            }
        });

        // Autofocus previous input box on backspace
        document.getElementById('excluded-letters').addEventListener('keydown', (event) => {
            const input = event.target;
            if (event.key === 'Backspace' && input.value.length === 0) {
                const prevInput = input.previousElementSibling;
                if (prevInput) {
                    prevInput.focus();
                }
            }
        });

        // Load word list on page load
        window.onload = loadWordList;
    </script>
</body>
</html>
